(function(){var f=function(j,k){return function(){return j.apply(k,arguments);};};function e(k){var j=this;this.option={infoView:false};$.extend(this.option,k);
this.scrollPossible=true;this.frame={root:j,current:0,old:0,total:0,estimate:0,estimation:a,update:i,direction:0};this.scene={root:j,current:0,old:0,total:0,estimate:0,estimation:g,update:h,scene:null,type:null,jump:null,link:null};
this.type={current:null,old:null};this.direction="";this.scenes=[];this.actors=[];touchPosY=0;this.browserCheck();this.addEvent();}function i(j){if(this.current<0){this.current+=-this.current*0.7;
}if(this.current>this.total){this.current+=(this.total-this.current)*0.7;}this.current+=j;this.direction=this.current-this.old;this.old=this.current;this.estimate=this.current;
}function h(j){this.current=j;this.scene=this.root.scenes[this.current];this.type=this.scene.type;this.estimate=this.current;}function a(j){this.estimate+=j;
}function g(){for(var j in this.root.scenes){this.root.scenes[j].estimation();}}e.prototype.constructor=e;e.prototype.addEvent=function(){this.onResize=f(this.onResize,this);
$(window).bind("resize",this.onResize);this.onResize();};e.prototype.EVENT_DELETE_SCROLL="delete_scroll";e.prototype.addScene=function(j,m,l,k){if(typeof this.scenes[j]=="undefined"){this.scenes[j]=new d(j,m,l,this);
if(typeof k!="undefined"){this.scenes[j].option=k;}this.frame.total+=m;if(this.scene.total==0){this.scene.update(0);}this.scene.total=this.scenes.length-1;
for(var n in this.scenes){this.scenes[n].init();}}};e.prototype.removeScene=function(j){};e.prototype.addToScene=function(j,k){if(typeof this.getScene(j)!="undefined"){this.getScene(j).add(k);
}};e.prototype.addToActor=function(k,j,m){var l=new c(k,j,m);l.stage=this;this.actors.push(l);};e.prototype.scrollPossibleOn=function(j){var k=this;setTimeout(function(){k.scrollPossible=true;
},j);};e.prototype.update=function(k,j){if(k==0){return;}var j=this.scene.type,m,l;if(this.scrollPossible){this.frame.estimation(k);this.scene.estimation();
m=this.scene.estimate;}if(this.scene.current!=this.scene.estimate){if(!this.scrollPossible){return;}if(k>0){this.frame.update(this.getScene(this.scene.estimate).frame.start-this.frame.current);
console.log(this.frame.current,this.frame.estimate);this.animation();}else{this.frame.update(this.getScene(this.scene.estimate).frame.end-this.frame.current);
console.log(this.frame.current,this.frame.estimate);this.animation();this.scene.current=m;this.scene.estimate=m;this.scene.type=this.getScene(this.scene.estimate).type;
}this.scrollPossible=false;this.scrollPossibleOn(300);}else{if(!this.scrollPossible){return;}if(j=="normal"){this.frame.update(k);this.animation();}else{if(j=="quick"){if(k>0){l=this.getScene(this.scene.current+1);
this.direction=1;}else{l=this.getScene(this.scene.current);this.direction=-1;}if(typeof l!="undefined"){this.gotoAndScene(l.id);}}}}};e.prototype.nextScene=function(){if(this.scene.current<this.scene.total){var j=this.scene.current+1;
this.scrollPossible=false;this.gotoAndFrame(this.scenes[j].frame.start);this.scene.update(j);}};e.prototype.prevScene=function(){if(this.scene.current>0){var j=this.scene.current-1;
this.scrollPossible=false;this.gotoAndFrame(this.scenes[j].frame.start);this.scene.update(j);}};e.prototype.gotoAndScene=function(j){this.scrollPossible=false;
if(this.scene.current<j){this.direction=1;this.gotoAndFrame(this.getScene(j).frame.start,this.getScene(this.scene.current).option);}else{this.direction=0;
this.gotoAndFrame(this.getScene(j).frame.start,this.getScene(this.scene.current).option);}};e.prototype.animation=function(){for(var k in this.scenes){this.scenes[k].update();
}for(var j in this.actors){this.actors[j].update();}if(this.option.infoView){this.status();}};e.prototype.gotoAndFrame=function(j,n){var p={current:j,estimate:j},m=this,l=typeof n!="undefined"?n:{duration:1000,ease:"easeInOutQuint"};
$(this.frame).stop().clearQueue().animate(p,{step:k,duration:l.duration,easing:l.ease,complete:o});function o(){k();$(m).trigger(m.EVENT_DELETE_SCROLL);
m.scrollPossible=true;var q=m.scene.scene.option;if(m.direction>0){if(q.jump&&typeof q.jump.next!="undefined"){m.gotoAndScene(m.scene.scene.option.jump.next);
}}else{if(q.jump&&typeof q.jump.prev!="undefined"){m.gotoAndScene(m.scene.scene.option.jump.prev);}}}function k(){m.animation();}};e.prototype.getScene=function(j){return this.scenes[j];
};e.prototype.onResize=function(){this.sw=this.windowWidth();this.sh=this.windowHeight();this.animation();};e.prototype.status=function(){if(typeof this.sceneStatus=="undefined"){this.sceneStatus="<div id='sceneStatus' style='position:absolute; z-index:1000000; padding:10px; font-size:12px; background-color:#000; color:#fff'></div>";
$("body").prepend(this.sceneStatus);this.sceneStatus=$("#sceneStatus");}this.sceneStatus.html("<br>frame ="+this.frame.current.toFixed(1)+"<br>totalframe = "+this.frame.total+"<br>currentScene = "+this.scene.current);
};function d(m,l,k,j){this.id=m;this.type=k;this.parent=j;this.option={};this.progress=0;this.oldProgress=0;this.objs;this.init=function(){var n=0;for(var p in this.parent.scenes){if(p<this.id){n+=this.parent.scenes[p].frame.total;
}}this.frame={start:n,end:n+l,total:l};};this.add=function(n){if(typeof this.objs=="undefined"){this.objs=[];}n=f(n,this);this.objs.push(n);};this.remove=function(){};
this.update=function(){this.progress=(this.parent.frame.current-this.frame.start)/this.frame.total;if(this.progress>=0&&this.progress<=1){this.sceneCheck();
for(var n in this.objs){this.objs[n]();}}else{this.overCheck();}this.oldProgress=this.progress;};this.sceneCheck=function(){if(this.progress>=0&&this.progress<=1){this.parent.scene.update(this.id);
}};this.estimation=function(){var n=(this.parent.frame.estimate-this.frame.start)/this.frame.total;if(n>=0&&n<1){this.parent.scene.estimate=this.id;}};
this.overCheck=function(){if(this.progress<0){this.progress=0;}if(this.progress>1){this.progress=1;}if(this.oldProgress!=this.progress){for(var n in this.objs){this.objs[n]();
}}};this.timefactor=function(p,o){var q=typeof o=="undefined"?(this.frame.total-p):o,n=(this.parent.frame.current-this.frame.start-p)/q;if(n<0){n=0;}if(n>1){n=1;
}return n;};}d.prototype.constructor=d;function c(l,k,j){this.stage=null;this.act=j;this.progress=0;this.oldProgress=0;this.frame={start:l,end:l+k,total:k};
this.update=function(){this.progress=(this.stage.frame.current-this.frame.start)/this.frame.total;if(this.progress>=0&&this.progress<=1){this.act();}else{this.overCheck();
}this.oldProgress=this.progress;};this.overCheck=function(){if(this.progress<0){this.progress=0;}if(this.progress>1){this.progress=1;}if(this.oldProgress!=this.progress){if(Math.floor(this.oldProgress)==1||Math.floor(this.oldProgress)==0){this.act();
}}};}c.prototype.constructor=c;function b(j){return typeof j!="undefined"?j:"undefined";}e.prototype.windowWidth=function(){if(document.documentElement.clientWidth){this.sw=document.documentElement.clientWidth;
}else{if(document.body.clientWidth){this.sw=document.body.clientWidth;}else{if(window.innerWidth){this.sw=window.innerWidth;}}}};e.prototype.windowHeight=function(){if(document.documentElement.clientHeight){this.sh=document.documentElement.clientHeight;
}else{if(document.body.clientHeight){this.sh=document.body.clientHeight;}else{if(window.innerHeight){this.sh=window.innerHeight;}}}};e.prototype.browserCheck=function(){this.ua=navigator.userAgent.toLowerCase();
return{isIE:/msie (\d+)/.test(this.ua),isIE6:/msie (\d+)/.test(this.ua)&&RegExp.$1==6,isIE7:/msie (\d+)/.test(this.ua)&&RegExp.$1==7,isIE8:/msie (\d+)/.test(this.ua)&&RegExp.$1==8,isIE9:/msie (\d+)/.test(this.ua)&&RegExp.$1==9,isLtIE9:/msie (\d+)/.test(this.ua)&&RegExp.$1<9};
};this.Scenes=e;}).call(this);